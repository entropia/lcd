diff -Nru prboom-2.2.2/src/SDL/Makefile.am prboom-2.2.2-lcd/src/SDL/Makefile.am
--- prboom-2.2.2/src/SDL/Makefile.am	Sun Dec 30 02:12:55 2001
+++ prboom-2.2.2-lcd/src/SDL/Makefile.am	Sun Dec 30 02:12:12 2001
@@ -7,6 +7,6 @@
 
 noinst_LIBRARIES = libsdldoom.a
 
-libsdldoom_a_SOURCES = i_video.c i_sound.c i_system.c i_joy.c
+libsdldoom_a_SOURCES = i_video.c i_sound.c i_system.c i_joy.c output.c
 
 
diff -Nru prboom-2.2.2/src/SDL/Makefile.in prboom-2.2.2-lcd/src/SDL/Makefile.in
--- prboom-2.2.2/src/SDL/Makefile.in	Sun Dec 30 02:13:02 2001
+++ prboom-2.2.2-lcd/src/SDL/Makefile.in	Sun Dec 30 02:13:13 2001
@@ -93,7 +93,7 @@
 
 noinst_LIBRARIES = libsdldoom.a
 
-libsdldoom_a_SOURCES = i_video.c i_sound.c i_system.c i_joy.c
+libsdldoom_a_SOURCES = i_video.c i_sound.c i_system.c i_joy.c output.c
 mkinstalldirs = $(SHELL) $(top_srcdir)/autotools/mkinstalldirs
 CONFIG_HEADER = ../../config.h
 CONFIG_CLEAN_FILES = 
@@ -109,7 +109,7 @@
 X_EXTRA_LIBS = @X_EXTRA_LIBS@
 X_PRE_LIBS = @X_PRE_LIBS@
 libsdldoom_a_LIBADD = 
-libsdldoom_a_OBJECTS =  i_video.o i_sound.o i_system.o i_joy.o
+libsdldoom_a_OBJECTS =  i_video.o i_sound.o i_system.o i_joy.o output.o
 AR = ar
 COMPILE = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
 CCLD = $(CC)
diff -Nru prboom-2.2.2/src/SDL/font.h prboom-2.2.2-lcd/src/SDL/font.h
--- prboom-2.2.2/src/SDL/font.h	Thu Jan  1 01:00:00 1970
+++ prboom-2.2.2-lcd/src/SDL/font.h	Sun Dec 30 02:12:12 2001
@@ -0,0 +1,128 @@
+0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x24,0x42,0x81,0xe7,0x24,0x24,0x3c,
+0x3c,0x24,0x24,0xe7,0x81,0x42,0x24,0x18,0x18,0x14,0xf2,0x81,0x81,0xf2,0x14,0x18,
+0x18,0x28,0x4f,0x81,0x81,0x4f,0x28,0x18,0xff,0x81,0x81,0x81,0x81,0x81,0x81,0xff,
+0xf8,0x88,0x8f,0x89,0xf9,0x41,0x41,0x7f,0xff,0x89,0x89,0x89,0xf9,0x81,0x81,0xff,
+0x01,0x03,0x06,0x8c,0xd8,0x70,0x20,0x00,0x7e,0xc3,0xd3,0xd3,0xdb,0xc3,0xc3,0x7e,
+0x18,0x3c,0x2c,0x2c,0x7e,0x18,0x18,0x00,0x10,0x1c,0x12,0x10,0x10,0x70,0xf0,0x60,
+0xf0,0xc0,0xfe,0xd8,0xde,0x18,0x18,0x00,0x70,0xc8,0xde,0xdb,0xdb,0x7e,0x1b,0x1b,
+0x00,0x00,0x00,0xff,0xff,0xff,0x00,0x00,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,
+0x7c,0xc6,0xc6,0x00,0xc6,0xc6,0x7c,0x00,0x06,0x06,0x06,0x00,0x06,0x06,0x06,0x00,
+0x7c,0x06,0x06,0x7c,0xc0,0xc0,0x7c,0x00,0x7c,0x06,0x06,0x7c,0x06,0x06,0x7c,0x00,
+0xc6,0xc6,0xc6,0x7c,0x06,0x06,0x06,0x00,0x7c,0xc0,0xc0,0x7c,0x06,0x06,0x7c,0x00,
+0x7c,0xc0,0xc0,0x7c,0xc6,0xc6,0x7c,0x00,0x7c,0x06,0x06,0x00,0x06,0x06,0x06,0x00,
+0x7c,0xc6,0xc6,0x7c,0xc6,0xc6,0x7c,0x00,0x7c,0xc6,0xc6,0x7c,0x06,0x06,0x7c,0x00,
+0x00,0x3c,0x46,0x06,0x7e,0x66,0x3c,0x00,0x78,0x66,0x7d,0x64,0x7e,0x03,0x0b,0x06,
+0x00,0x00,0x00,0x1f,0x1f,0x1f,0x1c,0x1c,0x00,0x00,0x00,0xfc,0xfc,0xfc,0x1c,0x1c,
+0x1c,0x1c,0x1c,0x1f,0x1f,0x1f,0x00,0x00,0x1c,0x1c,0x1c,0xfc,0xfc,0xfc,0x00,0x00,
+0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x18,0x18,0x18,0x00,0x18,0x00,
+0x66,0x66,0x44,0x00,0x00,0x00,0x00,0x00,0x00,0x24,0x7e,0x24,0x24,0x7e,0x24,0x00,
+0x14,0x3e,0x55,0x3c,0x1e,0x55,0x3e,0x14,0x62,0x66,0x0c,0x18,0x30,0x66,0x46,0x00,
+0x78,0xcc,0x61,0xce,0xcc,0xcc,0x78,0x00,0x18,0x18,0x10,0x00,0x00,0x00,0x00,0x00,
+0x04,0x08,0x18,0x18,0x18,0x18,0x08,0x04,0x20,0x10,0x18,0x18,0x18,0x18,0x10,0x20,
+0x00,0x54,0x38,0xfe,0x38,0x54,0x00,0x00,0x00,0x18,0x18,0x7e,0x18,0x18,0x00,0x00,
+0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x20,0x00,0x00,0x00,0x3c,0x00,0x00,0x00,0x00,
+0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x03,0x06,0x0c,0x18,0x30,0x60,0xc0,0x00,
+0x3c,0x66,0x6e,0x76,0x66,0x66,0x3c,0x00,0x18,0x38,0x18,0x18,0x18,0x18,0x18,0x00,
+0x3c,0x66,0x0e,0x1c,0x38,0x70,0x7e,0x00,0x7e,0x0c,0x18,0x3c,0x06,0x46,0x3c,0x00,
+0x0c,0x1c,0x2c,0x4c,0x7e,0x0c,0x0c,0x00,0x7e,0x60,0x7c,0x06,0x06,0x46,0x3c,0x00,
+0x1c,0x20,0x60,0x7c,0x66,0x66,0x3c,0x00,0x7e,0x06,0x0e,0x1c,0x18,0x18,0x18,0x00,
+0x3c,0x66,0x66,0x3c,0x66,0x66,0x3c,0x00,0x3c,0x66,0x66,0x3e,0x06,0x0c,0x38,0x00,
+0x00,0x18,0x18,0x00,0x00,0x18,0x18,0x00,0x00,0x18,0x18,0x00,0x18,0x18,0x10,0x00,
+0x06,0x0c,0x18,0x30,0x18,0x0c,0x06,0x00,0x00,0x00,0x3c,0x00,0x00,0x3c,0x00,0x00,
+0x60,0x30,0x18,0x0c,0x18,0x30,0x60,0x00,0x3c,0x46,0x06,0x0c,0x18,0x18,0x00,0x18,
+0x3c,0x66,0x6e,0x6a,0x6e,0x60,0x3c,0x00,0x3c,0x66,0x66,0x7e,0x66,0x66,0x66,0x00,
+0x7c,0x66,0x66,0x7c,0x66,0x66,0x7c,0x00,0x3c,0x62,0x60,0x60,0x60,0x62,0x3c,0x00,
+0x7c,0x66,0x66,0x66,0x66,0x66,0x7c,0x00,0x7e,0x60,0x60,0x7c,0x60,0x60,0x7e,0x00,
+0x7e,0x60,0x60,0x7c,0x60,0x60,0x60,0x00,0x3c,0x62,0x60,0x6e,0x66,0x66,0x3e,0x00,
+0x66,0x66,0x66,0x7e,0x66,0x66,0x66,0x00,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x00,
+0x06,0x06,0x06,0x06,0x06,0x46,0x3c,0x00,0x66,0x6c,0x78,0x70,0x78,0x6c,0x66,0x00,
+0x60,0x60,0x60,0x60,0x60,0x60,0x7c,0x00,0xfc,0xd6,0xd6,0xd6,0xd6,0xc6,0xc6,0x00,
+0x62,0x72,0x7a,0x5e,0x4e,0x46,0x42,0x00,0x3c,0x66,0x66,0x66,0x66,0x66,0x3c,0x00,
+0x7c,0x66,0x66,0x7c,0x60,0x60,0x60,0x00,0x3c,0x66,0x66,0x66,0x66,0x66,0x3c,0x06,
+0x7c,0x66,0x66,0x7c,0x66,0x66,0x66,0x00,0x3c,0x62,0x70,0x3c,0x0e,0x46,0x3c,0x00,
+0x7e,0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x66,0x66,0x66,0x66,0x66,0x66,0x3c,0x00,
+0x66,0x66,0x66,0x66,0x66,0x64,0x78,0x00,0xc6,0xc6,0xc6,0xd6,0xd6,0xd6,0xfc,0x00,
+0x66,0x66,0x66,0x3c,0x66,0x66,0x66,0x00,0x66,0x66,0x66,0x3c,0x18,0x18,0x18,0x00,
+0x7e,0x0e,0x1c,0x38,0x70,0x60,0x7e,0x00,0x1e,0x18,0x18,0x18,0x18,0x18,0x1e,0x00,
+0x40,0x60,0x30,0x18,0x0c,0x06,0x02,0x00,0x78,0x18,0x18,0x18,0x18,0x18,0x78,0x00,
+0x10,0x38,0x6c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7e,0x00,
+0x00,0xc0,0xc0,0x60,0x00,0x00,0x00,0x00,0x00,0x3c,0x46,0x3e,0x66,0x66,0x3e,0x00,
+0x60,0x7c,0x66,0x66,0x66,0x66,0x7c,0x00,0x00,0x3c,0x62,0x60,0x60,0x62,0x3c,0x00,
+0x06,0x3e,0x66,0x66,0x66,0x66,0x3e,0x00,0x00,0x3c,0x66,0x7e,0x60,0x62,0x3c,0x00,
+0x1e,0x30,0x7c,0x30,0x30,0x30,0x30,0x00,0x00,0x3e,0x66,0x66,0x66,0x3e,0x46,0x3c,
+0x60,0x7c,0x66,0x66,0x66,0x66,0x66,0x00,0x18,0x00,0x18,0x18,0x18,0x18,0x18,0x00,
+0x00,0x08,0x18,0x18,0x18,0x18,0x58,0x30,0x60,0x64,0x68,0x70,0x78,0x6c,0x66,0x00,
+0x18,0x18,0x18,0x18,0x18,0x18,0x0c,0x00,0x00,0xfc,0xd6,0xd6,0xd6,0xd6,0xc6,0x00,
+0x00,0x7c,0x66,0x66,0x66,0x66,0x66,0x00,0x00,0x3c,0x66,0x66,0x66,0x66,0x3c,0x00,
+0x00,0x7c,0x66,0x66,0x66,0x7c,0x60,0x60,0x00,0x3e,0x66,0x66,0x66,0x66,0x3e,0x06,
+0x00,0x6c,0x70,0x60,0x60,0x60,0x60,0x00,0x00,0x3c,0x72,0x38,0x1c,0x4e,0x3c,0x00,
+0x18,0x3c,0x18,0x18,0x18,0x18,0x0c,0x00,0x00,0x66,0x66,0x66,0x66,0x66,0x3e,0x00,
+0x00,0x66,0x66,0x66,0x66,0x64,0x78,0x00,0x00,0xc6,0xc6,0xd6,0xd6,0xd6,0xfc,0x00,
+0x00,0x66,0x66,0x3c,0x66,0x66,0x66,0x00,0x00,0x66,0x66,0x66,0x26,0x1e,0x46,0x3c,
+0x00,0x7e,0x0e,0x1c,0x38,0x70,0x7e,0x00,0x0e,0x18,0x18,0x30,0x18,0x18,0x0e,0x00,
+0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x70,0x18,0x18,0x0c,0x18,0x18,0x70,0x00,
+0x00,0x60,0xf2,0x9e,0x0c,0x00,0x00,0x00,0x10,0x10,0x28,0x28,0x44,0x44,0x82,0xfe,
+0x3c,0x62,0x60,0x60,0x60,0x62,0x1c,0x30,0x24,0x00,0x66,0x66,0x66,0x66,0x3e,0x00,
+0x0c,0x18,0x00,0x3c,0x7e,0x60,0x3c,0x00,0x18,0x66,0x00,0x3c,0x06,0x7e,0x3e,0x00,
+0x24,0x00,0x3c,0x46,0x3e,0x46,0x3e,0x00,0x30,0x18,0x00,0x3c,0x06,0x7e,0x3e,0x00,
+0x18,0x18,0x00,0x3c,0x06,0x7e,0x3e,0x00,0x00,0x3c,0x62,0x60,0x62,0x3c,0x08,0x18,
+0x18,0x34,0x00,0x3c,0x7e,0x60,0x3e,0x00,0x24,0x00,0x3c,0x66,0x7e,0x60,0x3e,0x00,
+0x30,0x18,0x00,0x3c,0x7e,0x60,0x3c,0x00,0x24,0x00,0x18,0x18,0x18,0x18,0x18,0x00,
+0x18,0x24,0x00,0x18,0x18,0x18,0x18,0x00,0x10,0x08,0x00,0x18,0x18,0x18,0x18,0x00,
+0x24,0x00,0x3c,0x66,0x7e,0x66,0x66,0x00,0x18,0x00,0x3c,0x66,0x7e,0x66,0x66,0x00,
+0x0c,0x18,0x7e,0x60,0x7c,0x60,0x7e,0x00,0x00,0x00,0x7e,0x1b,0x7f,0xd8,0x7e,0x00,
+0x3f,0x78,0xd8,0xde,0xf8,0xd8,0xdf,0x00,0x18,0x34,0x00,0x3c,0x66,0x66,0x3c,0x00,
+0x24,0x00,0x3c,0x66,0x66,0x66,0x3c,0x00,0x30,0x18,0x00,0x3c,0x66,0x66,0x3c,0x00,
+0x18,0x24,0x00,0x66,0x66,0x66,0x3c,0x00,0x30,0x18,0x00,0x66,0x66,0x66,0x3c,0x00,
+0x66,0x00,0x66,0x66,0x66,0x3e,0x46,0x3c,0x66,0x00,0x3c,0x66,0x66,0x66,0x3c,0x00,
+0x66,0x00,0x66,0x66,0x66,0x66,0x3c,0x00,0x18,0x3c,0x62,0x60,0x60,0x62,0x3c,0x18,
+0x1c,0x3a,0x30,0x7c,0x30,0x30,0x7e,0x00,0x66,0x66,0x3c,0x18,0x3c,0x18,0x18,0x00,
+0x3c,0x66,0x66,0x6c,0x66,0x66,0xec,0x00,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,
+0x0c,0x18,0x00,0x3c,0x06,0x7e,0x3e,0x00,0x0c,0x18,0x00,0x18,0x18,0x18,0x18,0x00,
+0x0c,0x18,0x00,0x3c,0x66,0x66,0x3c,0x00,0x0c,0x18,0x00,0x66,0x66,0x66,0x3e,0x00,
+0x34,0x58,0x00,0x7c,0x66,0x66,0x66,0x00,0x1a,0x2c,0x62,0x72,0x5a,0x4e,0x46,0x00,
+0x00,0x3c,0x46,0x3e,0x66,0x3e,0x00,0x7e,0x00,0x3c,0x66,0x66,0x66,0x3c,0x00,0x7e,
+0x00,0x18,0x00,0x18,0x30,0x60,0x66,0x3c,0x00,0x00,0x00,0x3e,0x30,0x30,0x30,0x00,
+0x00,0x00,0x00,0x7c,0x0c,0x0c,0x0c,0x00,0x62,0xe4,0x68,0x76,0x2b,0x43,0x86,0x0f,
+0x62,0xe4,0x68,0x76,0x2e,0x56,0x9f,0x06,0x00,0x18,0x00,0x18,0x18,0x18,0x18,0x18,
+0x1b,0x36,0x6c,0xd8,0x6c,0x36,0x1b,0x00,0xd8,0x6c,0x36,0x1b,0x36,0x6c,0xd8,0x00,
+0x34,0x58,0x00,0x3c,0x06,0x7e,0x3e,0x00,0x34,0x58,0x00,0x3c,0x66,0x66,0x3c,0x00,
+0x02,0x3c,0x66,0x6e,0x76,0x66,0x3c,0x40,0x00,0x02,0x3c,0x6e,0x76,0x66,0x3c,0x40,
+0x00,0x00,0x7e,0xdb,0xde,0xd8,0x7f,0x00,0x00,0x7e,0xd8,0xd8,0xfc,0xd8,0xd8,0xde,
+0x20,0x10,0x3c,0x66,0x66,0x7e,0x66,0x66,0x34,0x58,0x3c,0x66,0x66,0x7e,0x66,0x66,
+0x34,0x58,0x3c,0x66,0x66,0x66,0x66,0x3c,0x66,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
+0x0c,0x18,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x38,0x10,0x10,0x10,0x00,0x00,
+0x7a,0xca,0xca,0xca,0x7a,0x0a,0x0a,0x0a,0x3c,0x42,0x99,0xb5,0xb1,0x9d,0x42,0x3c,
+0x3c,0x42,0xb9,0xb5,0xb9,0xb5,0x42,0x3c,0xf1,0x5b,0x55,0x51,0x51,0x00,0x00,0x00,
+0x66,0x00,0xe6,0x66,0x66,0xf6,0x06,0x1c,0xf6,0x66,0x66,0x66,0x66,0xf6,0x06,0x1c,
+0x00,0x66,0x76,0x3c,0x6e,0x66,0x00,0x00,0x00,0x7c,0x0c,0x0c,0x0c,0x7e,0x00,0x00,
+0x00,0x1e,0x06,0x0e,0x1e,0x36,0x00,0x00,0x00,0x7e,0x0c,0x0c,0x0c,0x0c,0x00,0x00,
+0x00,0x7c,0x06,0x66,0x66,0x66,0x00,0x00,0x00,0x1c,0x0c,0x0c,0x0c,0x0c,0x00,0x00,
+0x00,0x1e,0x0c,0x06,0x06,0x06,0x00,0x00,0x00,0x7e,0x36,0x36,0x36,0x36,0x00,0x00,
+0x60,0x6e,0x66,0x66,0x66,0x7e,0x00,0x00,0x00,0x3c,0x0c,0x0c,0x00,0x00,0x00,0x00,
+0x00,0x3e,0x06,0x06,0x06,0x3e,0x00,0x00,0x60,0x7e,0x06,0x06,0x06,0x0e,0x00,0x00,
+0x00,0x6c,0x3e,0x66,0x66,0x6e,0x00,0x00,0x00,0x1c,0x0c,0x0c,0x0c,0x3c,0x00,0x00,
+0x00,0x3e,0x36,0x36,0x36,0x1c,0x00,0x00,0x00,0x36,0x36,0x36,0x36,0x7e,0x00,0x00,
+0x00,0x7e,0x66,0x76,0x06,0x7e,0x00,0x00,0x00,0x66,0x66,0x3c,0x0e,0x7e,0x00,0x00,
+0x00,0x3e,0x06,0x36,0x36,0x34,0x30,0x00,0x00,0x78,0x0c,0x0c,0x0c,0x0c,0x00,0x00,
+0x00,0xd6,0xd6,0xd6,0xd6,0xfe,0x00,0x00,0x00,0x7c,0x6c,0x6c,0x6c,0xec,0x00,0x00,
+0x00,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x00,0x00,0x3e,0x06,0x06,0x06,0x06,0x06,0x00,
+0x00,0xfe,0x66,0x66,0x66,0x7e,0x00,0x00,0x00,0x7e,0x66,0x76,0x06,0x06,0x06,0x00,
+0x00,0x36,0x36,0x1c,0x0c,0x0c,0x0c,0x00,0x1c,0x32,0x3c,0x66,0x66,0x3c,0x4c,0x38,
+0x00,0x10,0x38,0x6c,0xc6,0x82,0x00,0x00,0x66,0xf7,0x99,0x99,0xef,0x66,0x00,0x00,
+0x00,0x00,0x76,0xdc,0xc8,0xdc,0x76,0x00,0x1c,0x36,0x66,0x7c,0x66,0x66,0x7c,0x60,
+0x00,0xfe,0x66,0x62,0x60,0x60,0x60,0xf8,0x00,0x00,0xfe,0x6c,0x6c,0x6c,0x6c,0x48,
+0xfe,0x66,0x30,0x18,0x30,0x66,0xfe,0x00,0x00,0x1e,0x38,0x6c,0x6c,0x6c,0x38,0x00,
+0x00,0x00,0x6c,0x6c,0x6c,0x6c,0x7f,0xc0,0x00,0x00,0x7e,0x18,0x18,0x18,0x18,0x10,
+0x3c,0x18,0x3c,0x66,0x66,0x3c,0x18,0x3c,0x00,0x3c,0x66,0x7e,0x66,0x66,0x3c,0x00,
+0x00,0x3c,0x66,0x66,0x66,0x24,0x66,0x00,0x1c,0x36,0x78,0xdc,0xcc,0xec,0x78,0x00,
+0x0c,0x18,0x38,0x54,0x54,0x38,0x30,0x60,0x00,0x10,0x7c,0xd6,0xd6,0xd6,0x7c,0x10,
+0x3e,0x70,0x60,0x7e,0x60,0x70,0x3e,0x00,0x3c,0x66,0x66,0x66,0x66,0x66,0x66,0x00,
+0x00,0x7e,0x00,0x7e,0x00,0x7e,0x00,0x00,0x18,0x18,0x7e,0x18,0x18,0x00,0x7e,0x00,
+0x30,0x18,0x0c,0x18,0x30,0x00,0x7e,0x00,0x0c,0x18,0x30,0x18,0x0c,0x00,0x7e,0x00,
+0x00,0x0e,0x1b,0x1b,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0x18,0xd8,0xd8,0x70,0x00,
+0x18,0x18,0x00,0x7e,0x00,0x18,0x18,0x00,0x00,0x32,0x4c,0x00,0x32,0x4c,0x00,0x00,
+0x38,0x6c,0x38,0x00,0x00,0x00,0x00,0x00,0x38,0x7c,0x38,0x00,0x00,0x00,0x00,0x00,
+0x00,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x00,0x0f,0x18,0xd8,0x70,0x30,0x00,
+0x38,0x6c,0x6c,0x6c,0x6c,0x00,0x00,0x00,0x38,0x6c,0x18,0x30,0x7c,0x00,0x00,0x00,
+0x78,0x0c,0x38,0x0c,0x78,0x00,0x00,0x00,0x00,0xfe,0x00,0x00,0x00,0x00,0x00,0x00
diff -Nru prboom-2.2.2/src/SDL/freescope.files prboom-2.2.2-lcd/src/SDL/freescope.files
--- prboom-2.2.2/src/SDL/freescope.files	Thu Jan  1 01:00:00 1970
+++ prboom-2.2.2-lcd/src/SDL/freescope.files	Sun Dec 30 02:12:12 2001
@@ -0,0 +1,8 @@
+./lcd.h
+./i_video.c
+./font.h
+./output.c
+./output.h
+./i_joy.c
+./i_system.c
+./i_sound.c
diff -Nru prboom-2.2.2/src/SDL/i_video.c prboom-2.2.2-lcd/src/SDL/i_video.c
--- prboom-2.2.2/src/SDL/i_video.c	Sun Dec 30 02:12:55 2001
+++ prboom-2.2.2-lcd/src/SDL/i_video.c	Sun Dec 30 02:12:12 2001
@@ -46,6 +46,8 @@
 
 #include "SDL.h"
 
+#include "output.h"
+
 #include "i_system.h"
 #include "m_argv.h"
 #include "doomstat.h"
@@ -334,13 +336,13 @@
 ///////////////////////////////////////////////////////////
 // Palette stuff.
 //
+static SDL_Color* colours;
 static void I_UploadNewPalette(int pal)
 {
   // This is used to replace the current 256 colour cmap with a new one
   // Used by 256 colour PseudoColor modes
 
   // Array of SDL_Color structs used for setting the 256-colour palette 
-  static SDL_Color* colours;
   static int cachedgamma;
   static size_t num_pals;
 
@@ -447,6 +449,35 @@
     newpal = NO_PALETTE_CHANGE;
   } else
     SDL_Flip(screen);
+
+  // LCD Hack
+  {
+    static dither=0;
+    static threshold=70;
+    int limit;
+    float x, y;
+    int pixel;
+
+    dither=1-dither;
+    clearscreen();
+    pixel=0;
+    for (x=0; x< XSIZE; x++) {
+        for (y=0; y< YSIZE; y++) {
+            int c=colours[((char*)screen->pixels)[((int)(y*SCREENHEIGHT/YSIZE) * SCREENWIDTH + (int)(x*SCREENWIDTH/XSIZE))]].r+
+                  colours[((char*)screen->pixels)[((int)(y*SCREENHEIGHT/YSIZE) * SCREENWIDTH + (int)(x*SCREENWIDTH/XSIZE))]].g+
+                  colours[((char*)screen->pixels)[((int)(y*SCREENHEIGHT/YSIZE) * SCREENWIDTH + (int)(x*SCREENWIDTH/XSIZE))]].b;
+
+            limit=threshold+((int)(x+y)%3)*10+dither*5;
+            if (c < limit * 3) {
+                pixel++; 
+                setpixel(x,y);
+            }
+        }
+    }
+    
+    writescreen();
+  }
+
 #else
   // proff 04/05/2000: swap OpenGL buffers
   gld_Finish();
diff -Nru prboom-2.2.2/src/SDL/lcd.h prboom-2.2.2-lcd/src/SDL/lcd.h
--- prboom-2.2.2/src/SDL/lcd.h	Thu Jan  1 01:00:00 1970
+++ prboom-2.2.2-lcd/src/SDL/lcd.h	Sun Dec 30 02:12:12 2001
@@ -0,0 +1,7 @@
+// LCD Defines
+
+#define DEVICE "/dev/lcd0"
+#define BANKS 8
+#define XSIZE (105)
+#define YSIZE (BANKS*8)
+
diff -Nru prboom-2.2.2/src/SDL/output.c prboom-2.2.2-lcd/src/SDL/output.c
--- prboom-2.2.2/src/SDL/output.c	Thu Jan  1 01:00:00 1970
+++ prboom-2.2.2-lcd/src/SDL/output.c	Sun Dec 30 02:12:12 2001
@@ -0,0 +1,134 @@
+#include <unistd.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <fcntl.h>
+#include <string.h>
+#include <stdio.h>
+
+#include "output.h"
+
+// Define für asciitest
+//#define TEST
+#define CLRSCR "\27[2J" // FIXME
+
+
+char screen[XSIZE*YSIZE]; 
+#define SCR_AT(x,y) screen[(x)+(y)*XSIZE]
+
+char font[256*8] = {
+#include "font.h"
+};
+
+#define FONTBIT(c, x, y) (font[(c)*8+(y)] & (1<<(7-(x))))
+
+void writescreen() {
+#ifdef TEST
+    int x, y;
+    //printf(CLRSCR);
+    for (y=0; y<YSIZE; y++) {
+        for (x=0; x<XSIZE; x++) {
+            if (SCR_AT(x,y)) 
+                printf("#");
+            else
+                printf(" ");
+        }
+    }
+
+#else    
+    char buf[XSIZE*YSIZE/8];
+    int bank, x, pos, bit;
+    
+    int devfp;
+
+    #define SCR_SHIFT(x, bank, bit) (SCR_AT(x, (bank)*8 + bit) << bit)
+    
+    pos=0;
+    for (bank = 0; bank < BANKS; bank++) {
+        for (x = 0; x < XSIZE; x++) {
+            buf[pos]=0;
+            for (bit=0; bit < 8; bit++) {
+                buf[pos] |= SCR_SHIFT(x, bank, bit);
+            }
+            pos++;
+        }
+    }
+
+    devfp=open(DEVICE, O_WRONLY);
+    write(devfp, &buf, XSIZE*YSIZE/8);
+    close(devfp);
+
+#endif
+}
+
+void clearscreen() {
+    bzero(&screen, XSIZE*YSIZE);
+}
+
+void setpixel(int x, int y) {
+    if (x>XSIZE || x<0 || y>YSIZE || y<0)
+        return;
+
+    SCR_AT(x, y)=1;
+}
+
+void unsetpixel(int x, int y) {
+    if (x>XSIZE || x<0 || y>YSIZE || y<0)
+        return;
+
+    SCR_AT(x, y)=1;
+}
+
+void setblock(int x1, int y1, int x2, int y2) {
+    int x,y;
+    if (x1>x2 || y1>y2)
+        return;
+    if (x1<0) x1=0;
+    if (x2>=XSIZE) x2=XSIZE-1;
+    if (y1<0) y1=0;
+    if (y2>=YSIZE) y2=YSIZE-1;
+
+    for (y=y1; y<=y2; y++) {
+        for (x=x1; x<=x2; x++) {
+            SCR_AT(x, y)=1;
+        }
+    }
+}
+
+void putcharacter(char blah, int x, int y, int zoom) {
+    int bx, by, zoomx, zoomy;
+
+    if (x > XSIZE || x + zoom * 8 < 0 || y > XSIZE || y + zoom * 8 < 0)
+        return;
+
+    for (by=0; by<8; by++) {
+        for (bx=0; bx<8; bx++) {
+            if (FONTBIT(blah, bx, by)) {
+                for (zoomy=0; zoomy<zoom; zoomy++) {
+                    for (zoomx=0; zoomx<zoom; zoomx++) {
+                        setpixel(x+zoom*bx+zoomx, y+zoom*by+zoomy);
+                    }
+                }
+            }
+        }
+    }
+}
+
+void putstring(char *string, int x, int y, int zoom, int spacing) {
+    int i;
+    for (i=0; i<strlen(string); i++) {
+        putcharacter(string[i], x + i * ((zoom*8) + spacing), y, zoom);
+    }
+}
+
+int stringwidth(char *string, int zoom, int spacing) {
+    return (zoom*8+spacing)*strlen(string);
+}
+
+void scrollup(int lines) {
+    if (lines == 0)
+        return;
+    if (lines>=YSIZE) 
+        lines=YSIZE-1;
+    memmove(&SCR_AT(0,0), &SCR_AT(0, lines), (YSIZE-lines+1)*XSIZE);
+    bzero(&SCR_AT(0, YSIZE-lines), lines*XSIZE);
+}
diff -Nru prboom-2.2.2/src/SDL/output.h prboom-2.2.2-lcd/src/SDL/output.h
--- prboom-2.2.2/src/SDL/output.h	Thu Jan  1 01:00:00 1970
+++ prboom-2.2.2-lcd/src/SDL/output.h	Sun Dec 30 02:12:12 2001
@@ -0,0 +1,15 @@
+#include "lcd.h"
+
+void writescreen();
+void clearscreen();
+
+void setpixel(int x, int y);
+void unsetpixel(int x, int y);
+#define putpixel(x, y) setpixel((x), (y))
+
+void putcharacter(char blah, int x, int y, int zoom);
+void putstring(char *string, int x, int y, int zoom, int spacing);
+int  stringwidth(char *string, int zoom, int spacing);
+
+void setblock(int x1, int y1, int x2, int y2);
+void scrollup(int lines);
diff -Nru prboom-2.2.2/src/r_data.c prboom-2.2.2-lcd/src/r_data.c
--- prboom-2.2.2/src/r_data.c	Sun Dec 30 02:12:55 2001
+++ prboom-2.2.2-lcd/src/r_data.c	Sun Dec 30 02:12:13 2001
@@ -698,7 +698,7 @@
 
 void R_InitTranMap(int progress)
 {
-  int lump = W_CheckNumForName("TRANMAP");
+  int lump = -1; // W_CheckNumForName("TRANMAP");
 
   // If a tranlucency filter map lump is present, use it
 
@@ -714,8 +714,9 @@
         unsigned char pct;
         unsigned char playpal[256];
       } cache;
-      FILE *cachefp = fopen(strcat(strcpy(fname, D_DoomExeDir()),
-                                   "/tranmap.dat"),"r+b");
+      FILE *cachefp = 0;
+          /*fopen(strcat(strcpy(fname, D_DoomExeDir()),
+                                   "/tranmap.dat"),"r+b");*/
 
       main_tranmap = my_tranmap = Z_Malloc(256*256, PU_STATIC, 0);  // killough 4/11/98
 
@@ -770,6 +771,7 @@
                   lprintf(LO_INFO,".");
                 for (j=0;j<256;j++,tp++)
                   {
+                      /*
                     register int color = 255;
                     register long err;
                     long r = pal_w1[0][j] + r1;
@@ -781,6 +783,8 @@
                           - pal[1][color]*g - pal[2][color]*b) < best)
                         best = err, *tp = color;
                     while (--color >= 0);
+                    */
+                      *tp=i;
                   }
               }
           }
diff -Nru prboom-2.2.2/src/r_draw.c prboom-2.2.2-lcd/src/r_draw.c
--- prboom-2.2.2/src/r_draw.c	Sun Dec 30 02:12:55 2001
+++ prboom-2.2.2-lcd/src/r_draw.c	Sun Dec 30 02:12:14 2001
@@ -176,14 +176,14 @@
     if (dc_texheight == 128) {
         while(count--)
         {
-                *dest = dc_colormap[dc_source[(frac>>FRACBITS)&127]];
+                *dest = dc_source[(frac>>FRACBITS)&127];
                 dest += SCREENWIDTH; 
                 frac += fracstep;
         }
     } else if (dc_texheight == 0) {
 	/* cph - another special case */
 	while (count--) {
-		*dest = dc_colormap[dc_source[frac>>FRACBITS]];
+		*dest = dc_source[frac>>FRACBITS]; //dc_colormap[dc_source[frac>>FRACBITS]];
 		dest += SCREENWIDTH;
 		frac += fracstep;
 	}
@@ -193,7 +193,7 @@
      {
          while (count>0)   // texture height is a power of 2 -- killough
            {
-             *dest = dc_colormap[dc_source[(frac>>FRACBITS) & heightmask]];
+             *dest = dc_source[(frac>>FRACBITS) & heightmask];
              dest += SCREENWIDTH; 
              frac += fracstep;
             count--;
@@ -217,7 +217,7 @@
              
              // heightmask is the Tutti-Frutti fix -- killough
              
-             *dest = dc_colormap[dc_source[frac>>FRACBITS]];
+             *dest = dc_source[frac>>FRACBITS];
              dest += SCREENWIDTH; 
              if ((frac += fracstep) >= (int)heightmask)
                frac -= heightmask;
@@ -462,7 +462,7 @@
       // Thus the "green" ramp of the player 0 sprite
       //  is mapped to gray, red, black/indigo. 
       
-      *dest = dc_colormap[dc_translation[dc_source[frac>>FRACBITS]]];
+      *dest = 255;//dc_colormap[dc_translation[dc_source[frac>>FRACBITS]]];
       dest += SCREENWIDTH;
         
       frac += fracstep; 
diff -Nru prboom-2.2.2/src/r_plane.c prboom-2.2.2-lcd/src/r_plane.c
--- prboom-2.2.2/src/r_plane.c	Sun Dec 30 02:12:55 2001
+++ prboom-2.2.2-lcd/src/r_plane.c	Sun Dec 30 02:12:16 2001
@@ -164,8 +164,9 @@
   if (!(ds_colormap = fixedcolormap))
     {
       index = distance >> LIGHTZSHIFT;
-      if (index >= MAXLIGHTZ )
-        index = MAXLIGHTZ-1;
+      //if (index >= MAXLIGHTZ )
+        //index = MAXLIGHTZ-1;
+      index=0;
       ds_colormap = planezlight[index];
     }
 
diff -Nru prboom-2.2.2/src/v_video.c prboom-2.2.2-lcd/src/v_video.c
--- prboom-2.2.2/src/v_video.c	Sun Dec 30 02:12:55 2001
+++ prboom-2.2.2-lcd/src/v_video.c	Sun Dec 30 02:12:17 2001
@@ -72,70 +72,70 @@
    208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,
    224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
    240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255},
-
-  {2,4,5,7,8,10,11,12,14,15,16,18,19,20,21,23,24,25,26,27,29,30,31,
-   32,33,34,36,37,38,39,40,41,42,44,45,46,47,48,49,50,51,52,54,55,
-   56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,
-   78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,
-   99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,
-   115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,129,
-   130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,
-   146,147,148,148,149,150,151,152,153,154,155,156,157,158,159,160,
-   161,162,163,163,164,165,166,167,168,169,170,171,172,173,174,175,
-   175,176,177,178,179,180,181,182,183,184,185,186,186,187,188,189,
-   190,191,192,193,194,195,196,196,197,198,199,200,201,202,203,204,
-   205,205,206,207,208,209,210,211,212,213,214,214,215,216,217,218,
-   219,220,221,222,222,223,224,225,226,227,228,229,230,230,231,232,
-   233,234,235,236,237,237,238,239,240,241,242,243,244,245,245,246,
-   247,248,249,250,251,252,252,253,254,255},
-
-  {4,7,9,11,13,15,17,19,21,22,24,26,27,29,30,32,33,35,36,38,39,40,42,
-   43,45,46,47,48,50,51,52,54,55,56,57,59,60,61,62,63,65,66,67,68,69,
-   70,72,73,74,75,76,77,78,79,80,82,83,84,85,86,87,88,89,90,91,92,93,
-   94,95,96,97,98,100,101,102,103,104,105,106,107,108,109,110,111,112,
-   113,114,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,
-   129,130,131,132,133,133,134,135,136,137,138,139,140,141,142,143,144,
-   144,145,146,147,148,149,150,151,152,153,153,154,155,156,157,158,159,
-   160,160,161,162,163,164,165,166,166,167,168,169,170,171,172,172,173,
-   174,175,176,177,178,178,179,180,181,182,183,183,184,185,186,187,188,
-   188,189,190,191,192,193,193,194,195,196,197,197,198,199,200,201,201,
-   202,203,204,205,206,206,207,208,209,210,210,211,212,213,213,214,215,
-   216,217,217,218,219,220,221,221,222,223,224,224,225,226,227,228,228,
-   229,230,231,231,232,233,234,235,235,236,237,238,238,239,240,241,241,
-   242,243,244,244,245,246,247,247,248,249,250,251,251,252,253,254,254,
-   255},
-
-  {8,12,16,19,22,24,27,29,31,34,36,38,40,41,43,45,47,49,50,52,53,55,
-   57,58,60,61,63,64,65,67,68,70,71,72,74,75,76,77,79,80,81,82,84,85,
-   86,87,88,90,91,92,93,94,95,96,98,99,100,101,102,103,104,105,106,107,
-   108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,
-   125,126,127,128,129,130,131,132,133,134,135,135,136,137,138,139,140,
-   141,142,143,143,144,145,146,147,148,149,150,150,151,152,153,154,155,
-   155,156,157,158,159,160,160,161,162,163,164,165,165,166,167,168,169,
-   169,170,171,172,173,173,174,175,176,176,177,178,179,180,180,181,182,
-   183,183,184,185,186,186,187,188,189,189,190,191,192,192,193,194,195,
-   195,196,197,197,198,199,200,200,201,202,202,203,204,205,205,206,207,
-   207,208,209,210,210,211,212,212,213,214,214,215,216,216,217,218,219,
-   219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,
-   231,231,232,233,233,234,235,235,236,237,237,238,238,239,240,240,241,
-   242,242,243,244,244,245,246,246,247,247,248,249,249,250,251,251,252,
-   253,253,254,254,255},
-
-  {16,23,28,32,36,39,42,45,48,50,53,55,57,60,62,64,66,68,69,71,73,75,76,
-   78,80,81,83,84,86,87,89,90,92,93,94,96,97,98,100,101,102,103,105,106,
-   107,108,109,110,112,113,114,115,116,117,118,119,120,121,122,123,124,
-   125,126,128,128,129,130,131,132,133,134,135,136,137,138,139,140,141,
-   142,143,143,144,145,146,147,148,149,150,150,151,152,153,154,155,155,
-   156,157,158,159,159,160,161,162,163,163,164,165,166,166,167,168,169,
-   169,170,171,172,172,173,174,175,175,176,177,177,178,179,180,180,181,
-   182,182,183,184,184,185,186,187,187,188,189,189,190,191,191,192,193,
-   193,194,195,195,196,196,197,198,198,199,200,200,201,202,202,203,203,
-   204,205,205,206,207,207,208,208,209,210,210,211,211,212,213,213,214,
-   214,215,216,216,217,217,218,219,219,220,220,221,221,222,223,223,224,
-   224,225,225,226,227,227,228,228,229,229,230,230,231,232,232,233,233,
-   234,234,235,235,236,236,237,237,238,239,239,240,240,241,241,242,242,
-   243,243,244,244,245,245,246,246,247,247,248,248,249,249,250,250,251,
-   251,252,252,253,254,254,255,255}
+  {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,
+   17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,
+   33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,
+   49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,
+   65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,
+   81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,
+   97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,
+   113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,
+   128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,
+   144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,
+   160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,
+   176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,
+   192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,
+   208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,
+   224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
+   240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255},
+  {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,
+   17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,
+   33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,
+   49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,
+   65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,
+   81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,
+   97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,
+   113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,
+   128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,
+   144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,
+   160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,
+   176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,
+   192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,
+   208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,
+   224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
+   240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255},
+  {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,
+   17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,
+   33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,
+   49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,
+   65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,
+   81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,
+   97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,
+   113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,
+   128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,
+   144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,
+   160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,
+   176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,
+   192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,
+   208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,
+   224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
+   240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255},
+  {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,
+   17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,
+   33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,
+   49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,
+   65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,
+   81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,
+   97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,
+   113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,
+   128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,
+   144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,
+   160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,
+   176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,
+   192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,
+   208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,
+   224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,
+   240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255},
 };
 
 int usegamma;
@@ -162,8 +162,6 @@
 
 // killough 5/2/98: table-driven approach
 static const crdef_t crdefs[] = {
-  {"CRBRICK",  &colrngs[CR_BRICK ]},
-  {"CRTAN",    &colrngs[CR_TAN   ]},
   {"CRGRAY",   &colrngs[CR_GRAY  ]},
   {"CRGREEN",  &colrngs[CR_GREEN ]},
   {"CRBROWN",  &colrngs[CR_BROWN ]},
